import{p as F,r as A,a as k,q as T,A as h,c as p,d as u,g as n,h as e,i as c,w as B,o as V,F as O,n as x,f as I,e as w}from"./index-D29wqbBU.js";import{T as $}from"./Toast-DeDTaYdu.js";import{u as E,_ as f}from"./rules-mAjpj8ah.js";import{p as N}from"./formatters-DwE89AP2.js";import{t as C,F as P}from"./TransferBetweenUsers-s2LgewhG.js";import{A as S}from"./AccountDropdown-tvPMAqm-.js";const R={class:"card col-md-6 col-lg-5 col-xl-4 p-4 m-4"},D=["disabled"],M={__name:"TransferFundsEmp",setup(v){const t=A(null),s=k(),{handleSubmit:d,meta:a,resetForm:_}=E({validationSchema:C,initialValues:{fromAccount:"",toAccount:"",amount:"",description:""}}),y=d(async m=>{try{const r={sourceAccount:m.fromAccount,targetAccount:m.toAccount,initiatedBy:s.user.id,amount:N(m.amount),description:m.description||null};(await T.post(h.transactions,r)).status===201?(t.value.setToast("Transaction created successfully!","success"),_()):t.value.setToast("Failed to create transaction. Please try again.","error")}catch{t.value.setToast("An error occurred while creating the transaction.","error")}});return(m,r)=>(u(),p("section",R,[r[1]||(r[1]=n("h1",{class:"text-center"},"Transfer Funds",-1)),n("form",{onSubmit:r[0]||(r[0]=B((...b)=>c(y)&&c(y)(...b),["prevent"])),class:"d-flex flex-column gap-2"},[e(f,{name:"fromAccount",label:"From IBAN"}),e(f,{name:"toAccount",label:"To IBAN"}),e(f,{name:"amount",label:"Amount to Transfer",type:"currency"}),e(f,{name:"description",label:"Description"}),n("button",{class:"btn btn-primary",type:"submit",disabled:!c(a).valid},"Transfer",8,D)],32),e($,{ref_key:"toastRef",ref:t},null,512)]))}},U=F(M,[["__scopeId","data-v-dcdaa2f3"]]),L=["disabled"],j={__name:"TransferBetweenOwnAccounts",props:{toast:Object},setup(v){const t=v,s=k(),d=A([]),a=A(0),{handleSubmit:_,meta:y,resetForm:m,setFieldValue:r}=E({validationSchema:C,initialValues:{fromAccount:"",toAccount:"",amount:"",description:""}});async function b(){try{const i=await T.get(h.accountsById(s.user.id));d.value=i.data}catch{t.toast.setToast("Faild to get accounts. Please try again","error")}}const g=_(async i=>{try{const o={sourceAccount:i.fromAccount,targetAccount:i.toAccount,initiatedBy:s.user.id,amount:N(i.amount),description:i.description||null};(await T.post(h.transactions,o)).status===201?(t.toast.setToast("Transaction created successfully!","success"),m(),a.value++,await b()):t.toast.setToast("Failed to create transaction. Please try again.","error")}catch{t.toast.setToast("An error occurred while creating the transaction.","error")}});return V(b),(i,o)=>(u(),p(O,null,[o[3]||(o[3]=n("h1",{class:"h2 text-center"},"Transfer Funds",-1)),(u(),p("form",{key:a.value,onSubmit:o[2]||(o[2]=B((...l)=>c(g)&&c(g)(...l),["prevent"])),class:"d-flex flex-column gap-2"},[e(S,{accounts:d.value,label:"From Account","onUpdate:selectedAccount":o[0]||(o[0]=l=>c(r)("fromAccount",l?l.iban:""))},null,8,["accounts"]),e(S,{accounts:d.value,label:"To Account","onUpdate:selectedAccount":o[1]||(o[1]=l=>c(r)("toAccount",l?l.iban:""))},null,8,["accounts"]),e(f,{name:"amount",label:"Amount to Transfer",type:"currency"}),e(f,{name:"description",label:"Description"}),n("button",{class:"btn btn-primary",type:"submit",disabled:!c(y).valid},"Transfer",8,L)],32))],64))}},q=F(j,[["__scopeId","data-v-9e2ba63e"]]),z={class:"card col-md-6 col-lg-5 col-xl-4 p-0 m-4"},K={class:"nav nav-tabs mb-0"},Y={class:"nav-item"},G={class:"nav-item"},H={class:"tab-content bg-white border border-top-0 rounded-bottom p-4"},J={key:0},Q={key:1},W={__name:"TransferFundsCus",setup(v){const t=A("lookup"),s=A(null);return(d,a)=>(u(),p("section",z,[n("ul",K,[n("li",Y,[n("button",{class:x(["nav-link",{active:t.value==="lookup"}]),onClick:a[0]||(a[0]=_=>t.value="lookup")}," IBAN Lookup ",2)]),n("li",G,[n("button",{class:x(["nav-link",{active:t.value==="transfer"}]),onClick:a[1]||(a[1]=_=>t.value="transfer")}," Transfer Funds ",2)])]),n("div",H,[t.value==="lookup"?(u(),p("div",J,[e(P,{toast:s.value},null,8,["toast"])])):t.value==="transfer"?(u(),p("div",Q,[e(q,{toast:s.value},null,8,["toast"])])):I("",!0)]),e($,{ref_key:"toastRef",ref:s},null,512)]))}},X=F(W,[["__scopeId","data-v-6ea594fa"]]),Z={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},rt={__name:"TransferFundsView",setup(v){const s=k().user.role;return(d,a)=>(u(),p("main",Z,[c(s)==="EMPLOYEE"?(u(),w(U,{key:0})):c(s)==="CUSTOMER"?(u(),w(X,{key:1})):I("",!0)]))}};export{rt as default};
