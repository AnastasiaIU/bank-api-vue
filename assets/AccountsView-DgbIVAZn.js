import{x as S,c as n,d as l,g as t,w as F,i as o,h as y,p as T,a as B,z as U,r as h,f as x,e as V,t as d,F as A,y as j,j as $,n as M}from"./index-C-tQbr0w.js";import{f as L,p as w}from"./formatters-DwE89AP2.js";import{c as R,i as C,k as z,u as I,_ as k}from"./rules-COm2wmVb.js";import{T as Z}from"./Toast-DX1XkFdk.js";const q=R({dailyLimit:C,absoluteLimit:z,withdrawLimit:C}),D={class:"modal fade show",tabindex:"-1",style:{display:"block"},"aria-modal":"true",role:"dialog"},O={class:"modal-dialog modal-dialog-centered"},G={class:"modal-content"},H={class:"modal-header"},J={class:"modal-body"},K={class:"modal-footer"},Q={__name:"UpdateLimitsModal",props:{account:{type:Object,required:!0}},emits:["close","submit"],setup(g,{emit:f}){const s=g,r=I({validationSchema:q}),{handleSubmit:u,resetForm:m}=r,b=f;S(()=>s.account,e=>{e&&m({values:{dailyLimit:e.dailyLimit?L(e.dailyLimit):"",absoluteLimit:e.absoluteLimit?L(e.absoluteLimit):"",withdrawLimit:e.withdrawLimit?L(e.withdrawLimit):""}})},{immediate:!0});const v=u(async e=>{b("submit",{iban:s.account.iban,dailyLimit:w(e.dailyLimit),absoluteLimit:w(e.absoluteLimit),withdrawLimit:w(e.withdrawLimit)})});return(e,a)=>(l(),n("div",null,[t("div",D,[t("div",O,[t("div",G,[t("form",{onSubmit:a[2]||(a[2]=F((...p)=>o(v)&&o(v)(...p),["prevent"]))},[t("div",H,[a[3]||(a[3]=t("h5",{class:"modal-title"},"Update Account Limits",-1)),t("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=p=>e.$emit("close")),"aria-label":"Close"})]),t("div",J,[y(k,{name:"dailyLimit",label:"Enter daily limit",type:"currency"}),y(k,{name:"absoluteLimit",label:"Enter absolute limit",type:"currency"}),y(k,{name:"withdrawLimit",label:"Enter withdraw limit",type:"currency"})]),t("div",K,[t("button",{type:"button",class:"btn btn-secondary",onClick:a[1]||(a[1]=p=>e.$emit("close"))}," Cancel "),a[4]||(a[4]=t("button",{type:"submit",class:"btn btn-primary"}," Save Changes ",-1))])],32)])])]),a[5]||(a[5]=t("div",{class:"modal-backdrop fade show"},null,-1))]))}},W={key:0,class:"container my-5"},X={class:"d-flex justify-content-between align-items-center mb-4"},Y=["disabled"],tt={key:0,class:"alert alert-danger text-center"},et={key:1,class:"table table-light table-bordered table-hover text-center align-middle"},st=["onClick"],at={key:1},it={"aria-label":"Page navigation example",class:"d-flex justify-content-center mt-4 align-items-center gap-3"},ot=["disabled"],lt={class:"text-muted fw-semibold"},nt=["disabled"],rt=10,ut={__name:"AccountsList",setup(g){const f=B(),s=U(),r=h(0),u=h(null),m=h(!1),b=h(null);function v(_){u.value=_}function e(){u.value&&(m.value=!0)}async function a(_){try{(await s.updateAccountLimits(_)).status===200?(m.value=!1,await p(),u.value=null,b.value.setToast("Account Limits Updated Successfully","success")):b.value.setToast("Failed to update account limits","error")}catch{b.value.setToast("Failed to update account limits","error")}}async function p(){s.fetchAllAccounts(r.value,rt)}S(r,p,{immediate:!0});function N(){r.value>0&&r.value--}function P(){s.isLastPage.value||r.value++}return(_,i)=>(l(),n(A,null,[o(f).isAuthenticated&&o(f).isEmployee?(l(),n("div",W,[t("div",X,[i[1]||(i[1]=t("h1",{class:"h2 m-0"},"Customer Accounts",-1)),t("button",{class:"btn btn-primary",onClick:e,disabled:!u.value}," Update Account Limits ",8,Y)]),o(s).error?(l(),n("div",tt,d(o(s).error),1)):(l(),n("table",et,[i[3]||(i[3]=t("thead",{class:"table-success"},[t("tr",null,[t("th",null,"Customer Name"),t("th",null,"IBAN"),t("th",null,"Type"),t("th",null,"Balance")])],-1)),t("tbody",null,[o(s).userAccounts.length>0?(l(!0),n(A,{key:0},j(o(s).userAccounts,(c,E)=>(l(),n("tr",{key:E,class:M(["clickable-row",{"table-active":u.value?.iban===c.iban}]),onClick:mt=>v(c)},[t("td",null,d(c.firstName)+" "+d(c.lastName),1),t("td",null,d(c.iban),1),t("td",null,d(c.type),1),t("td",null,d(o(L)(c.balance)),1)],10,st))),128)):(l(),n("tr",at,i[2]||(i[2]=[t("td",{colspan:"4",class:"text-center text-muted fw-semibold"}," No accounts found. ",-1)])))])])),t("nav",it,[t("button",{class:"btn btn-outline-primary",onClick:N,disabled:o(s).isFirstPage,title:"Previous Page"},i[4]||(i[4]=[t("i",{class:"bi bi-chevron-left"},null,-1),$(" Previous ")]),8,ot),t("span",lt," Page "+d(r.value+1)+" of "+d(o(s).totalPages),1),t("button",{class:"btn btn-outline-primary",onClick:P,disabled:o(s).isLastPage,title:"Next Page"},i[5]||(i[5]=[$(" Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]),8,nt)])])):x("",!0),m.value?(l(),V(Q,{key:1,account:u.value,onClose:i[0]||(i[0]=c=>m.value=!1),onSubmit:a},null,8,["account"])):x("",!0),y(Z,{ref_key:"toastRef",ref:b},null,512)],64))}},ct=T(ut,[["__scopeId","data-v-061b219c"]]),dt={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},vt={__name:"AccountsView",setup(g){return(f,s)=>(l(),n("main",dt,[y(ct)]))}};export{vt as default};
