import{r as c,c as y,d as m,g as t,l as G,s as z,a as H,x as L,u as U,o as K,y as R,q as S,A as $,f as h,n as A,e as k,t as C,F as D,z as M,j as q,h as J}from"./index-Be5eIUNQ.js";import{_ as Q}from"./TransactionCard-0EQYgPYe.js";import"./formatters-DwE89AP2.js";const W={class:"border p-3 rounded mb-3"},X={class:"mb-2"},Y={class:"row mb-3"},Z={class:"col-md-4"},tt=["value"],et={class:"col-md-4"},st=["value"],nt={class:"row mb-3"},at={class:"col-md-6"},lt=["value"],ot={class:"col-md-6"},rt=["value"],it={class:"row mb-3"},ut={class:"col-md-6"},ct=["value"],dt={class:"col-md-6"},vt=["value"],mt={__name:"TransactionFilters",props:{filters:Object},emits:["update:filters","submit","clear"],setup(d,{emit:I}){const i=d,f=I,o=c({...i.filters});function a(v,e){if(v==="amount"){const n=parseFloat(e);if(isNaN(n)||n<.01){o.value[v]="";return}}o.value[v]=e}function g(){f("update:filters",{...o.value}),f("submit")}function r(){Object.keys(o.value).forEach(v=>o.value[v]=""),f("update:filters",{}),f("clear")}return(v,e)=>(m(),y("div",W,[e[15]||(e[15]=t("h5",{class:"mb-3"},"Transaction Filters",-1)),t("div",X,[e[7]||(e[7]=t("label",{class:"form-label"},"Description",-1)),G(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=n=>o.value.description=n),placeholder:"e.g. groceries, transfer, salary"},null,512),[[z,o.value.description]])]),t("div",Y,[t("div",Z,[e[8]||(e[8]=t("label",{class:"form-label"},"Amount",-1)),t("input",{type:"number",step:"0.01",min:"0.01",class:"form-control",value:d.filters.amount,onInput:e[1]||(e[1]=n=>a("amount",n.target.value))},null,40,tt)]),t("div",et,[e[10]||(e[10]=t("label",{class:"form-label"},"Comparison",-1)),t("select",{class:"form-select",value:d.filters.comparison,onChange:e[2]||(e[2]=n=>a("comparison",n.target.value))},e[9]||(e[9]=[t("option",{value:""},"Select",-1),t("option",{value:"lt"},"Less than",-1),t("option",{value:"eq"},"Equal to",-1),t("option",{value:"gt"},"Greater than",-1)]),40,st)])]),e[16]||(e[16]=t("hr",null,null,-1)),t("div",nt,[t("div",at,[e[11]||(e[11]=t("label",{class:"form-label"},"Start Date",-1)),t("input",{type:"date",class:"form-control",value:d.filters.startDate,onInput:e[3]||(e[3]=n=>a("startDate",n.target.value))},null,40,lt)]),t("div",ot,[e[12]||(e[12]=t("label",{class:"form-label"},"End Date",-1)),t("input",{type:"date",class:"form-control",value:d.filters.endDate,onInput:e[4]||(e[4]=n=>a("endDate",n.target.value))},null,40,rt)])]),e[17]||(e[17]=t("hr",null,null,-1)),t("div",it,[t("div",ut,[e[13]||(e[13]=t("label",{class:"form-label"},"Source IBAN",-1)),t("input",{type:"text",class:"form-control",value:d.filters.sourceIban,onInput:e[5]||(e[5]=n=>a("sourceIban",n.target.value))},null,40,ct)]),t("div",dt,[e[14]||(e[14]=t("label",{class:"form-label"},"Target IBAN",-1)),t("input",{type:"text",class:"form-control",value:d.filters.targetIban,onInput:e[6]||(e[6]=n=>a("targetIban",n.target.value))},null,40,vt)])]),e[18]||(e[18]=t("hr",null,null,-1)),t("div",{class:"text-center"},[t("button",{type:"submit",class:"btn btn-primary me-2",onClick:g},"Apply Filters"),t("button",{type:"button",class:"btn btn-secondary",onClick:r},"Clear Filters")])]))}},bt={class:"m-3 text-center"},ft={key:0},pt={class:"h2 text-center mb-3"},yt={class:"text-center mb-3"},gt={key:1,class:"text-muted text-center"},It={class:"list-group mb-4"},_t={"aria-label":"Page navigation",class:"d-flex justify-content-center align-items-center m-4 gap-3"},xt=["disabled"],Ct={class:"text-muted fw-semibold"},ht=["disabled"],wt={__name:"TransactionList",setup(d){const I=H(),i=L(),f=U(),o=c([]),a=c(null),g=c([]),r=c(0),v=c(10),e=c(0),n=c(0),b=c({startDate:i.query.startDate||"",endDate:i.query.endDate||"",amount:i.query.amount||"",comparison:i.query.comparison||"",sourceIban:i.query.sourceIban||"",targetIban:i.query.targetIban||"",description:i.query.description||""}),_=c(!1);function E(){_.value=!_.value}function T(){Object.keys(b.value).forEach(l=>b.value[l]=""),w()}function V(l){b.value=l,w()}function w(){const l=Object.fromEntries(Object.entries(b.value).filter(([s,u])=>u!==""&&u!=null));f.push({query:l})}K(P),R(()=>i.query,l=>{Object.assign(b.value,l),p()});async function P(){try{const l=await S.get($.accountsById(I.user.id));o.value=l.data,o.value.length>0&&(a.value=o.value[0],await p())}catch(l){console.error("Failed to fetch accounts:",l)}}async function p(l=r.value){if(a.value)try{const s=new URLSearchParams;for(const[B,N]of Object.entries(b.value))N&&s.append(B,N);s.append("page",l),s.append("size",v.value);const u=`${$.accountTransactionsbyId(a.value.id)}?${s.toString()}`,x=await S.get(u);g.value=x.data.content,e.value=x.data.totalPages,n.value=x.data.totalElements,r.value=x.data.number}catch(s){console.error("Failed to fetch transactions:",s)}}function j(){r.value>0&&p(r.value-1)}function O(){r.value<e.value-1&&p(r.value+1)}function F(l){const s=o.value.find(u=>u.type===l);s&&s!==a.value&&(a.value=s,r.value=0,p(0))}return(l,s)=>(m(),y(D,null,[t("div",bt,[t("button",{class:A(["btn me-2",a.value?.type==="CHECKING"?"btn-primary":"btn-secondary"]),onClick:s[0]||(s[0]=u=>F("CHECKING"))}," View CHECKING ",2),t("button",{class:A(["btn",a.value?.type==="SAVINGS"?"btn-primary":"btn-secondary"]),onClick:s[1]||(s[1]=u=>F("SAVINGS"))}," View SAVINGS ",2)]),a.value?(m(),y("div",ft,[t("h1",pt,"Transactions for "+C(a.value.iban),1),t("div",yt,[t("button",{class:"btn btn-primary",onClick:E},C(_.value?"Hide Filters":"Show Filters"),1)]),_.value?(m(),k(mt,{key:0,filters:b.value,"onUpdate:filters":V,onSubmit:p,onClear:T},null,8,["filters"])):h("",!0),g.value.length===0?(m(),y("div",gt," No transactions found. ")):h("",!0),t("ul",It,[(m(!0),y(D,null,M(g.value,u=>(m(),k(Q,{key:u.id,transaction:u,"reference-iban":a.value.iban},null,8,["transaction","reference-iban"]))),128))]),t("nav",_t,[t("button",{class:"btn btn-outline-primary",onClick:j,disabled:r.value===0},s[2]||(s[2]=[t("i",{class:"bi bi-chevron-left"},null,-1),q(" Previous")]),8,xt),t("span",Ct," Page "+C(r.value+1)+" of "+C(e.value),1),t("button",{class:"btn btn-outline-primary",onClick:O,disabled:r.value>=e.value-1},s[3]||(s[3]=[q("Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]),8,ht)])])):h("",!0)],64))}},Ft={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},At={__name:"AccountTransactionsViews",setup(d){return(I,i)=>(m(),y("main",Ft,[J(wt)]))}};export{At as default};
