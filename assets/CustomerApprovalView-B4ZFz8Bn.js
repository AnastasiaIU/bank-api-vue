import{p as k,u as C,x as P,a as D,r as L,G as c,A as d,o as V,c as p,d as m,g as t,j as h,t as r,F as z,z as x,i as v,h as b,e as T}from"./index-BqQshk00.js";import{c as g,j as U,i as j,h as E,u as F,_ as y}from"./rules-Dw0mSE7w.js";import{p as A}from"./formatters-DwE89AP2.js";const O=g({accounts:U().of(g({dailyLimit:E,withdrawLimit:E,absoluteLimit:j}))}),Z={class:"container py-5"},G={class:"card shadow-sm p-4 border-top",style:{"border-top-width":"5px"}},J={class:"row"},M={class:"col-md-4 mb-4"},W={class:"col-md-8"},q={class:"table-responsive"},H={class:"table table-bordered align-middle table-hover"},K={class:"d-none"},Q={class:"mt-4 text-end"},X={__name:"CustomerApproval",setup($){const w=C(),l=P().params.id,N=F({validationSchema:O}),{handleSubmit:R}=N,u=D().token,i=L({}),n=L([]),_=R(s=>{const e=s.accounts.map((a,o)=>({iban:n.value[o].iban,status:n.value[o].status,type:n.value[o].type,balance:n.value[o].balance,dailyLimit:A(a.dailyLimit),withdrawLimit:A(a.withdrawLimit),absoluteLimit:A(a.absoluteLimit)}));f("APPROVED",{accounts:e})}),I=async()=>{try{const s=await c.get(d.usersById(l),{headers:{Authorization:`Bearer ${u}`}});i.value=s.data}catch(s){console.error("Error fetching user:",s)}},S=async()=>{try{const s=await c.get(d.accountsByIdReview(l),{headers:{Authorization:`Bearer ${u}`}});n.value=s.data}catch(s){console.error("Error fetching accounts:",s)}},f=async(s,e)=>{try{await c.put(d.usersApproval(l),{userAccountStatus:s},{headers:{Authorization:`Bearer ${u}`}}),s==="APPROVED"&&await c.post(d.userAccounts(l),e.accounts,{headers:{Authorization:`Bearer ${u}`}}),await w.push("/users/review")}catch(a){console.error("Error during approval:",a)}};return V(async()=>{await Promise.all([S(),I()])}),(s,e)=>(m(),p("div",Z,[t("div",G,[e[8]||(e[8]=t("h2",{class:"mb-4"},"User Account Review",-1)),t("div",J,[t("div",M,[e[5]||(e[5]=t("h5",{class:"mb-4"},"User Information",-1)),t("p",null,[e[2]||(e[2]=t("strong",null,"Name:",-1)),h(" "+r(i.value.firstName)+" "+r(i.value.lastName),1)]),t("p",null,[e[3]||(e[3]=t("strong",null,"Email:",-1)),h(" "+r(i.value.email),1)]),t("p",null,[e[4]||(e[4]=t("strong",null,"Phone:",-1)),h(" "+r(i.value.phoneNumber),1)])]),t("div",W,[e[7]||(e[7]=t("h5",{class:"mb-3"},"Account Configuration",-1)),t("div",q,[t("table",H,[e[6]||(e[6]=t("thead",{class:"table-light"},[t("tr",null,[t("th"),t("th",{class:"d-none"},"User ID"),t("th",null,"IBAN"),t("th",null,"Type"),t("th",null,"Daily Limit (€)"),t("th",null,"Withdraw Limit (€)"),t("th",null,"Absolute Limit (€)")])],-1)),t("tbody",null,[(m(!0),p(z,null,x(n.value,(a,o)=>(m(),p("tr",{key:a.iban},[t("td",null,r(o+1),1),t("td",K,r(v(l)),1),t("td",null,r(a.iban),1),t("td",null,r(a.type),1),t("td",null,[b(y,{name:`accounts[${o}].dailyLimit`,type:"currency",placeholder:"Enter daily limit"},null,8,["name"])]),t("td",null,[b(y,{name:`accounts[${o}].withdrawLimit`,type:"currency",placeholder:"Enter withdraw limit"},null,8,["name"])]),t("td",null,[b(y,{name:`accounts[${o}].absoluteLimit`,type:"currency",placeholder:"Enter absolute limit"},null,8,["name"])])]))),128))])])])])]),t("div",Q,[t("button",{class:"btn btn-success me-2",onClick:e[0]||(e[0]=(...a)=>v(_)&&v(_)(...a))},"Approve"),t("button",{class:"btn btn-danger",onClick:e[1]||(e[1]=a=>f("REJECTED"))},"Reject")])])]))}},Y=k(X,[["__scopeId","data-v-7f24fa8d"]]),ot={__name:"CustomerApprovalView",setup($){return(w,B)=>(m(),T(Y))}};export{ot as default};
