import{p as y,a as N,r as d,o as g,c as u,f as _,i as h,d as c,g as e,h as C,F as x,z as B,n as w,t as o,q as f,A as v,e as T}from"./index-Be5eIUNQ.js";import{T as U}from"./Toast-Cw206BUs.js";const I={key:0,class:"container my-5"},S={class:"d-flex justify-content-between align-items-center mb-4"},z=["disabled"],E={class:"table table-light table-bordered table-hover text-center align-middle"},F=["onClick"],V={class:"d-none"},$={key:0},D={__name:"ActiveUsers",setup(b){const l=N(),s=d(null),r=d(null),i=d([]);function A(a){s.value=a}async function p(){if(s.value)try{await f.put(v.closeUserAccountWithBankAcc(s.value.id),{},{headers:{Authorization:`Bearer ${l.token}`}}),r.value.setToast("User and all accounts closed successfully","success"),await m(),s.value=null}catch{r.value.setToast("Failed to close user and accounts","error")}}async function m(){try{const a=await f.get(v.activeAccounts,{headers:{Authorization:`Bearer ${l.token}`}});i.value=a.data}catch{r.value.setToast("Failed to load accounts","error")}}return g(m),(a,n)=>h(l).isAuthenticated&&h(l).isEmployee?(c(),u("div",I,[e("div",S,[n[0]||(n[0]=e("h1",{class:"h2 m-0"},"Active Customer Accounts",-1)),e("button",{class:"btn btn-danger",onClick:p,disabled:!s.value}," Close Account ",8,z)]),e("table",E,[n[2]||(n[2]=e("thead",{class:"table-success"},[e("tr",null,[e("th",{class:"d-none"},"User ID"),e("th",null,"Customer Name"),e("th",null,"BSN"),e("th",null,"Email"),e("th",null,"Phone Number")])],-1)),e("tbody",null,[(c(!0),u(x,null,B(i.value,(t,k)=>(c(),u("tr",{key:k,class:w(["clickable-row",{"table-active":s.value?.iban===t.iban}]),onClick:R=>A(t)},[e("td",V,o(t.userId),1),e("td",null,o(t.firstName)+" "+o(t.lastName),1),e("td",null,o(t.bsn),1),e("td",null,o(t.email),1),e("td",null,o(t.phoneNumber),1)],10,F))),128)),i.value.length===0?(c(),u("tr",$,n[1]||(n[1]=[e("td",{colspan:"4",class:"text-center text-muted fw-semibold"}," No active accounts found. ",-1)]))):_("",!0)])]),C(U,{ref_key:"toastRef",ref:r},null,512)])):_("",!0)}},P=y(D,[["__scopeId","data-v-a5a29b05"]]),L={__name:"ActiveUsersAccountsView",setup(b){return(l,s)=>(c(),T(P))}};export{L as default};
