import{p as h,r as v,q as T,A as y,c as p,d as u,g as o,h as e,i as r,w as S,a as $,o as O,F as R,n as k,f as B,e as g}from"./index-ZX3uO6H3.js";import{T as E}from"./Toast-B6FA6vjR.js";import{c as M,h as P,i as V,j as x,u as C,_ as b}from"./rules-BPMM-q5A.js";import{p as N}from"./formatters-DwE89AP2.js";import{t as D,F as U}from"./TransferBetweenUsers-BZpA1j4R.js";import{A as w}from"./AccountDropdown-CtqVc2P6.js";const j=M({fromAccount:x,toAccount:x,amount:V,description:P().nullable()}),L={class:"card col-md-6 col-lg-5 col-xl-4 p-4 m-4"},q=["disabled"],z={__name:"TransferFundsEmp",setup(A){const t=v(null),{handleSubmit:n,meta:d,resetForm:a}=C({validationSchema:j,validateOnMount:!0}),f=n(async m=>{try{const c={sourceAccount:m.fromAccountIban,targetAccount:m.toAccountIban,amount:N(m.amount),description:m.description||null};(await T.post(y.transactions,c)).status===201?(t.value.setToast("Transaction created successfully!","success"),a()):t.value.setToast("Failed to create transaction. Please try again.","error")}catch{t.value.setToast("An error occurred while creating the transaction.","error")}});return(m,c)=>(u(),p("section",L,[c[1]||(c[1]=o("h1",{class:"text-center"},"Transfer Funds",-1)),o("form",{onSubmit:c[0]||(c[0]=S((..._)=>r(f)&&r(f)(..._),["prevent"])),class:"d-flex flex-column gap-2"},[e(b,{name:"fromAccountIban",label:"From IBAN"}),e(b,{name:"toAccountIban",label:"To IBAN"}),e(b,{name:"amount",label:"Amount to Transfer",type:"currency"}),e(b,{name:"description",label:"Description"}),o("button",{class:"btn btn-primary",type:"submit",disabled:!r(d).valid},"Transfer",8,q)],32),e(E,{ref_key:"toastRef",ref:t},null,512)]))}},K=h(z,[["__scopeId","data-v-8e01d2b8"]]),Y=["disabled"],Z={__name:"TransferBetweenOwnAccounts",props:{toast:Object},setup(A){const t=A,n=$(),d=v([]),a=v(0),{handleSubmit:f,meta:m,resetForm:c,setFieldValue:_}=C({validationSchema:D,initialValues:{fromAccountIban:"",toAccountIban:"",amount:"",description:""},validateOnMount:!0});async function F(){try{const l=await T.get(y.accountsById(n.user.id));d.value=l.data}catch{t.toast.setToast("Faild to get accounts. Please try again","error")}}const I=f(async l=>{try{const s={sourceAccount:l.fromAccountIban,targetAccount:l.toAccountIban,amount:N(l.amount),description:l.description||null};(await T.post(y.transactions,s)).status===201?(t.toast.setToast("Transaction created successfully!","success"),c(),a.value++,await F()):t.toast.setToast("Failed to create transaction. Please try again.","error")}catch{t.toast.setToast("An error occurred while creating the transaction.","error")}});return O(F),(l,s)=>(u(),p(R,null,[s[3]||(s[3]=o("h1",{class:"h2 text-center"},"Transfer Funds",-1)),(u(),p("form",{key:a.value,onSubmit:s[2]||(s[2]=S((...i)=>r(I)&&r(I)(...i),["prevent"])),class:"d-flex flex-column gap-2"},[e(w,{accounts:d.value,label:"From Account","onUpdate:selectedAccount":s[0]||(s[0]=i=>r(_)("fromAccountIban",i?i.iban:""))},null,8,["accounts"]),e(w,{accounts:d.value,label:"To Account","onUpdate:selectedAccount":s[1]||(s[1]=i=>r(_)("toAccountIban",i?i.iban:""))},null,8,["accounts"]),e(b,{name:"amount",label:"Amount to Transfer",type:"currency"}),e(b,{name:"description",label:"Description"}),o("button",{class:"btn btn-primary",type:"submit",disabled:!r(m).valid},"Transfer",8,Y)],32))],64))}},G=h(Z,[["__scopeId","data-v-cc54164d"]]),H={class:"card col-md-6 col-lg-5 col-xl-4 p-0 m-4"},J={class:"nav nav-tabs mb-0"},Q={class:"nav-item"},W={class:"nav-item"},X={class:"tab-content bg-white border border-top-0 rounded-bottom p-4"},tt={key:0},et={key:1},st={__name:"TransferFundsCus",setup(A){const t=v("lookup"),n=v(null);return(d,a)=>(u(),p("section",H,[o("ul",J,[o("li",Q,[o("button",{class:k(["nav-link",{active:t.value==="lookup"}]),onClick:a[0]||(a[0]=f=>t.value="lookup")}," IBAN Lookup ",2)]),o("li",W,[o("button",{class:k(["nav-link",{active:t.value==="transfer"}]),onClick:a[1]||(a[1]=f=>t.value="transfer")}," Transfer Funds ",2)])]),o("div",X,[t.value==="lookup"?(u(),p("div",tt,[e(U,{toast:n.value},null,8,["toast"])])):t.value==="transfer"?(u(),p("div",et,[e(G,{toast:n.value},null,8,["toast"])])):B("",!0)]),e(E,{ref_key:"toastRef",ref:n},null,512)]))}},ot=h(st,[["__scopeId","data-v-6ea594fa"]]),nt={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},dt={__name:"TransferFundsView",setup(A){const n=$().user.role;return(d,a)=>(u(),p("main",nt,[r(n)==="EMPLOYEE"?(u(),g(K,{key:0})):r(n)==="CUSTOMER"?(u(),g(ot,{key:1})):B("",!0)]))}};export{dt as default};
