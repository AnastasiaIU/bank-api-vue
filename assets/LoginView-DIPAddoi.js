import{u as T,a as $,r as c,o as F,b as V,c as d,d as l,e as A,f as h,g as s,S as B,h as t,w as C,i as k,_ as N,t as M,j as u,k as j,F as D}from"./index-DWyc0-Aj.js";import{T as P}from"./Toast-cqWzQQjH.js";import{c as z,p as W,e as Y,u as q,_ as G}from"./rules-CK4UMEM4.js";import{_ as H}from"./BasePasswordInput-vHhK7u_M.js";import"./formatters-DwE89AP2.js";const I=z({email:Y,password:W}),J={class:"card col-md-6 col-lg-5 col-xl-4 p-4 m-4"},K={key:0,class:"alert alert-danger",role:"alert"},O={class:"form-group"},Q={class:"form-group mb-2"},U={__name:"LoginForm",setup(S){const p=T(),o=$(),i=c(!1),f=c(null),r=c(""),g=q({validationSchema:I}),{handleSubmit:R}=g;F(()=>{o.wasRegistered&&(f.value.displayToast(),o.setWasRegistered(!1))});const _=R(async y=>{i.value=!0,r.value="",setTimeout(async()=>{var e,n;try{await o.login(y),p.push("/")}catch(a){const m=((n=(e=a==null?void 0:a.response)==null?void 0:e.data)==null?void 0:n.message)||"An error occurred. Please try again.",v=Array.isArray(m)?m:[m];let x=!1;for(const E of v){const[w,...L]=E.split(": "),b=L.join(": ").trim();w&&b&&(g.setFieldError(w,b),x=!0)}x||(r.value=v[0])}finally{i.value=!1}},3e3)});return(y,e)=>{const n=V("router-link");return l(),d(D,null,[i.value?(l(),A(B,{key:0,size:"md",message:"Logging in..."})):h("",!0),s("section",J,[s("form",{class:"d-flex flex-column gap-2",onSubmit:e[0]||(e[0]=C((...a)=>k(_)&&k(_)(...a),["prevent"]))},[t(N),e[4]||(e[4]=s("p",{class:"h5 mb-3 medium-grey-text text-center"},"Log in to your account",-1)),r.value?(l(),d("div",K,M(r.value),1)):h("",!0),s("div",O,[t(G,{name:"email",label:"Email address",type:"email",placeholder:"Enter email"})]),s("div",Q,[t(H,{name:"password",label:"Password",placeholder:"Enter password"})]),e[5]||(e[5]=s("button",{type:"submit",class:"btn btn-primary mb-3"},"Log in",-1)),s("p",null,[e[2]||(e[2]=u(" Don't have an account? ")),t(n,{to:"/register",class:"link-opacity-75-hover"},{default:j(()=>e[1]||(e[1]=[u("Sign up")])),_:1}),e[3]||(e[3]=u(". "))])],32),t(P,{ref_key:"toastRef",ref:f,text:"Registration successful! You can log in now.",variant:"success"},null,512)])],64)}}},X={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},oe={__name:"LoginView",setup(S){return(p,o)=>(l(),d("main",X,[t(U)]))}};export{oe as default};
