import{p as S,u as C,s as P,a as D,r as L,E as c,A as d,o as V,c as p,d as m,g as t,j as h,t as r,F as x,y as z,i as b,h as v,e as T}from"./index-Ruav_iho.js";import{c as E,m as U,k as F,i as g,u as O,_ as y}from"./rules-B6NnyYMd.js";import{p as w}from"./formatters-DwE89AP2.js";const j=E({accounts:U().of(E({dailyLimit:g,withdrawLimit:g,absoluteLimit:F}))}),Z={class:"container py-5"},J={class:"card shadow-sm p-4 border-top border-primary",style:{"border-top-width":"5px"}},M={class:"row"},W={class:"col-md-4 mb-4"},q={class:"col-md-8"},G={class:"table-responsive"},H={class:"table table-bordered align-middle table-hover"},K={class:"d-none"},Q={class:"mt-4 text-end"},X={__name:"CustomerApproval",setup($){const A=C(),n=P().params.id,N=O({validationSchema:j}),{handleSubmit:R}=N,u=D().token,l=L({}),i=L([]),_=R(s=>{const e=s.accounts.map((a,o)=>({iban:i.value[o].iban,type:i.value[o].type,balance:i.value[o].balance,dailyLimit:w(a.dailyLimit),withdrawLimit:w(a.withdrawLimit),absoluteLimit:w(a.absoluteLimit)}));f("APPROVED",{accounts:e})}),k=async()=>{try{const s=await c.get(d.usersById(n),{headers:{Authorization:`Bearer ${u}`}});l.value=s.data}catch(s){console.error("Error fetching user:",s)}},I=async()=>{try{const s=await c.get(d.accountsByIdReview(n),{headers:{Authorization:`Bearer ${u}`}});i.value=s.data}catch(s){console.error("Error fetching accounts:",s)}},f=async(s,e)=>{try{await c.put(d.usersApproval(n),{approvalStatus:s},{headers:{Authorization:`Bearer ${u}`}}),s==="APPROVED"&&await c.post(d.userAccounts(n),e.accounts,{headers:{Authorization:`Bearer ${u}`}}),await A.push("/users/review")}catch(a){console.error("Error during approval:",a)}};return V(async()=>{await Promise.all([I(),k()])}),(s,e)=>(m(),p("div",Z,[t("div",J,[e[8]||(e[8]=t("h2",{class:"mb-4"},"User Account Review",-1)),t("div",M,[t("div",W,[e[5]||(e[5]=t("h5",{class:"mb-4"},"User Information",-1)),t("p",null,[e[2]||(e[2]=t("strong",null,"Name:",-1)),h(" "+r(l.value.firstName)+" "+r(l.value.lastName),1)]),t("p",null,[e[3]||(e[3]=t("strong",null,"Email:",-1)),h(" "+r(l.value.email),1)]),t("p",null,[e[4]||(e[4]=t("strong",null,"Phone:",-1)),h(" "+r(l.value.phoneNumber),1)])]),t("div",q,[e[7]||(e[7]=t("h5",{class:"mb-3"},"Account Configuration",-1)),t("div",G,[t("table",H,[e[6]||(e[6]=t("thead",{class:"table-light"},[t("tr",null,[t("th"),t("th",{class:"d-none"},"User ID"),t("th",null,"IBAN"),t("th",null,"Type"),t("th",null,"Daily Limit (€)"),t("th",null,"Withdraw Limit (€)"),t("th",null,"Absolute Limit (€)")])],-1)),t("tbody",null,[(m(!0),p(x,null,z(i.value,(a,o)=>(m(),p("tr",{key:a.iban},[t("td",null,r(o+1),1),t("td",K,r(b(n)),1),t("td",null,r(a.iban),1),t("td",null,r(a.type),1),t("td",null,[v(y,{name:`accounts[${o}].dailyLimit`,type:"currency",placeholder:"Enter daily limit"},null,8,["name"])]),t("td",null,[v(y,{name:`accounts[${o}].withdrawLimit`,type:"currency",placeholder:"Enter withdraw limit"},null,8,["name"])]),t("td",null,[v(y,{name:`accounts[${o}].absoluteLimit`,type:"currency",placeholder:"Enter absolute limit"},null,8,["name"])])]))),128))])])])])]),t("div",Q,[t("button",{class:"btn btn-success me-2",onClick:e[0]||(e[0]=(...a)=>b(_)&&b(_)(...a))},"Approve"),t("button",{class:"btn btn-danger",onClick:e[1]||(e[1]=a=>f("REJECTED"))},"Reject")])])]))}},Y=S(X,[["__scopeId","data-v-fc2d0901"]]),ot={__name:"CustomerApprovalView",setup($){return(A,B)=>(m(),T(Y))}};export{ot as default};
