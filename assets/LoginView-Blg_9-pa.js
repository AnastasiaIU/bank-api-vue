import{u as E,a as L,r as m,o as T,b as $,c as u,d as l,e as F,f as w,g as s,S as V,h as t,w as A,i as b,_ as B,t as C,j as c,k as N,F as M}from"./index-oKZRfg3L.js";import{T as j}from"./Toast-CLO_RLE1.js";import{c as D,p as P,e as z,u as W,_ as Y}from"./rules-Cp-iGYJw.js";import{_ as q}from"./BasePasswordInput-D8s8BE4t.js";import"./formatters-DwE89AP2.js";const G=D({email:z,password:P}),H={class:"card col-md-6 col-lg-5 col-xl-4 p-4 m-4"},I={key:0,class:"alert alert-danger",role:"alert"},J={class:"form-group"},K={class:"form-group mb-2"},O={__name:"LoginForm",setup(h){const d=E(),o=L(),i=m(!1),p=m(null),r=m(""),f=W({validationSchema:G}),{handleSubmit:k}=f;T(()=>{o.wasRegistered&&(p.value.displayToast(),o.setWasRegistered(!1))});const g=k(async _=>{i.value=!0,r.value="",setTimeout(async()=>{try{await o.login(_),d.push("/")}catch(e){const a=e?.response?.data?.message||"An error occurred. Please try again.",n=Array.isArray(a)?a:[a];let y=!1;for(const S of n){const[v,...R]=S.split(": "),x=R.join(": ").trim();v&&x&&(f.setFieldError(v,x),y=!0)}y||(r.value=n[0])}finally{i.value=!1}},3e3)});return(_,e)=>{const a=$("router-link");return l(),u(M,null,[i.value?(l(),F(V,{key:0,size:"md",message:"Logging in..."})):w("",!0),s("section",H,[s("form",{class:"d-flex flex-column gap-2",onSubmit:e[0]||(e[0]=A((...n)=>b(g)&&b(g)(...n),["prevent"]))},[t(B),e[4]||(e[4]=s("p",{class:"h5 mb-3 medium-grey-text text-center"},"Log in to your account",-1)),r.value?(l(),u("div",I,C(r.value),1)):w("",!0),s("div",J,[t(Y,{name:"email",label:"Email address",type:"email",placeholder:"Enter email"})]),s("div",K,[t(q,{name:"password",label:"Password",placeholder:"Enter password"})]),e[5]||(e[5]=s("button",{type:"submit",class:"btn btn-primary mb-3"},"Log in",-1)),s("p",null,[e[2]||(e[2]=c(" Don't have an account? ")),t(a,{to:"/register",class:"link-opacity-75-hover"},{default:N(()=>e[1]||(e[1]=[c("Sign up")])),_:1}),e[3]||(e[3]=c(". "))])],32),t(j,{ref_key:"toastRef",ref:p,text:"Registration successful! You can log in now.",variant:"success"},null,512)])],64)}}},Q={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},te={__name:"LoginView",setup(h){return(d,o)=>(l(),u("main",Q,[t(O)]))}};export{te as default};
