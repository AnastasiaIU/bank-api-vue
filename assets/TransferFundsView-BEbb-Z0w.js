import{p as F,r as A,a as k,q as T,A as h,c as p,d as u,g as n,h as e,i as c,w as B,o as O,F as R,n as x,f as $,e as S}from"./index-BckZrGKl.js";import{T as E}from"./Toast-BYd54BrC.js";import{c as V,h as M,i as P,j as w,u as C,_ as f}from"./rules-D0Wjpa1F.js";import{p as N}from"./formatters-DwE89AP2.js";import{t as D,F as U}from"./TransferBetweenUsers-DBLO2Vgn.js";import{A as I}from"./AccountDropdown-CjjVcfn3.js";const j=V({fromAccount:w,toAccount:w,amount:P,description:M().nullable()}),L={class:"card col-md-6 col-lg-5 col-xl-4 p-4 m-4"},q=["disabled"],z={__name:"TransferFundsEmp",setup(v){const t=A(null),o=k(),{handleSubmit:d,meta:a,resetForm:_}=C({validationSchema:j,initialValues:{fromAccount:"",toAccount:"",amount:"",description:""},validateOnMount:!0}),y=d(async m=>{try{const r={sourceAccount:m.fromAccount,targetAccount:m.toAccount,initiatedBy:o.user.id,amount:N(m.amount),description:m.description||null};(await T.post(h.transactions,r)).status===201?(t.value.setToast("Transaction created successfully!","success"),_()):t.value.setToast("Failed to create transaction. Please try again.","error")}catch{t.value.setToast("An error occurred while creating the transaction.","error")}});return(m,r)=>(u(),p("section",L,[r[1]||(r[1]=n("h1",{class:"text-center"},"Transfer Funds",-1)),n("form",{onSubmit:r[0]||(r[0]=B((...b)=>c(y)&&c(y)(...b),["prevent"])),class:"d-flex flex-column gap-2"},[e(f,{name:"fromAccount",label:"From IBAN"}),e(f,{name:"toAccount",label:"To IBAN"}),e(f,{name:"amount",label:"Amount to Transfer",type:"currency"}),e(f,{name:"description",label:"Description"}),n("button",{class:"btn btn-primary",type:"submit",disabled:!c(a).valid},"Transfer",8,q)],32),e(E,{ref_key:"toastRef",ref:t},null,512)]))}},K=F(z,[["__scopeId","data-v-c4939f8d"]]),Y=["disabled"],Z={__name:"TransferBetweenOwnAccounts",props:{toast:Object},setup(v){const t=v,o=k(),d=A([]),a=A(0),{handleSubmit:_,meta:y,resetForm:m,setFieldValue:r}=C({validationSchema:D,initialValues:{fromAccountIban:"",toAccountIban:"",amount:"",description:""},validateOnMount:!0});async function b(){try{const l=await T.get(h.accountsById(o.user.id));d.value=l.data}catch{t.toast.setToast("Faild to get accounts. Please try again","error")}}const g=_(async l=>{try{const s={sourceAccount:l.fromAccountIban,targetAccount:l.toAccountIban,initiatedBy:o.user.id,amount:N(l.amount),description:l.description||null};(await T.post(h.transactions,s)).status===201?(t.toast.setToast("Transaction created successfully!","success"),m(),a.value++,await b()):t.toast.setToast("Failed to create transaction. Please try again.","error")}catch{t.toast.setToast("An error occurred while creating the transaction.","error")}});return O(b),(l,s)=>(u(),p(R,null,[s[3]||(s[3]=n("h1",{class:"h2 text-center"},"Transfer Funds",-1)),(u(),p("form",{key:a.value,onSubmit:s[2]||(s[2]=B((...i)=>c(g)&&c(g)(...i),["prevent"])),class:"d-flex flex-column gap-2"},[e(I,{accounts:d.value,label:"From Account","onUpdate:selectedAccount":s[0]||(s[0]=i=>c(r)("fromAccountIban",i?i.iban:""))},null,8,["accounts"]),e(I,{accounts:d.value,label:"To Account","onUpdate:selectedAccount":s[1]||(s[1]=i=>c(r)("toAccountIban",i?i.iban:""))},null,8,["accounts"]),e(f,{name:"amount",label:"Amount to Transfer",type:"currency"}),e(f,{name:"description",label:"Description"}),n("button",{class:"btn btn-primary",type:"submit",disabled:!c(y).valid},"Transfer",8,Y)],32))],64))}},G=F(Z,[["__scopeId","data-v-04a8082d"]]),H={class:"card col-md-6 col-lg-5 col-xl-4 p-0 m-4"},J={class:"nav nav-tabs mb-0"},Q={class:"nav-item"},W={class:"nav-item"},X={class:"tab-content bg-white border border-top-0 rounded-bottom p-4"},tt={key:0},et={key:1},ot={__name:"TransferFundsCus",setup(v){const t=A("lookup"),o=A(null);return(d,a)=>(u(),p("section",H,[n("ul",J,[n("li",Q,[n("button",{class:x(["nav-link",{active:t.value==="lookup"}]),onClick:a[0]||(a[0]=_=>t.value="lookup")}," IBAN Lookup ",2)]),n("li",W,[n("button",{class:x(["nav-link",{active:t.value==="transfer"}]),onClick:a[1]||(a[1]=_=>t.value="transfer")}," Transfer Funds ",2)])]),n("div",X,[t.value==="lookup"?(u(),p("div",tt,[e(U,{toast:o.value},null,8,["toast"])])):t.value==="transfer"?(u(),p("div",et,[e(G,{toast:o.value},null,8,["toast"])])):$("",!0)]),e(E,{ref_key:"toastRef",ref:o},null,512)]))}},st=F(ot,[["__scopeId","data-v-6ea594fa"]]),nt={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},dt={__name:"TransferFundsView",setup(v){const o=k().user.role;return(d,a)=>(u(),p("main",nt,[c(o)==="EMPLOYEE"?(u(),S(K,{key:0})):c(o)==="CUSTOMER"?(u(),S(st,{key:1})):$("",!0)]))}};export{dt as default};
