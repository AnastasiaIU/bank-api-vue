import{x as N,c as n,d as l,g as t,w as T,i as o,h as y,p as B,a as U,y as V,r as h,f as A,e as j,t as d,F as $,s as M,j as C,n as R}from"./index-DWyc0-Aj.js";import{f as L,p as w}from"./formatters-DwE89AP2.js";import{c as z,i as S,k as I,u as Z,_ as k}from"./rules-CK4UMEM4.js";import{T as q}from"./Toast-cqWzQQjH.js";const D=z({dailyLimit:S,absoluteLimit:I,withdrawLimit:S}),O={class:"modal fade show",tabindex:"-1",style:{display:"block"},"aria-modal":"true",role:"dialog"},G={class:"modal-dialog modal-dialog-centered"},H={class:"modal-content"},J={class:"modal-header"},K={class:"modal-body"},Q={class:"modal-footer"},W={__name:"UpdateLimitsModal",props:{account:{type:Object,required:!0}},emits:["close","submit"],setup(g,{emit:f}){const s=g,r=Z({validationSchema:D}),{handleSubmit:u,resetForm:m}=r,b=f;N(()=>s.account,e=>{e&&m({values:{dailyLimit:e.dailyLimit?L(e.dailyLimit):"",absoluteLimit:e.absoluteLimit?L(e.absoluteLimit):"",withdrawLimit:e.withdrawLimit?L(e.withdrawLimit):""}})},{immediate:!0});const v=u(async e=>{b("submit",{iban:s.account.iban,dailyLimit:w(e.dailyLimit),absoluteLimit:w(e.absoluteLimit),withdrawLimit:w(e.withdrawLimit)})});return(e,a)=>(l(),n("div",null,[t("div",O,[t("div",G,[t("div",H,[t("form",{onSubmit:a[2]||(a[2]=T((...p)=>o(v)&&o(v)(...p),["prevent"]))},[t("div",J,[a[3]||(a[3]=t("h5",{class:"modal-title"},"Update Account Limits",-1)),t("button",{type:"button",class:"btn-close",onClick:a[0]||(a[0]=p=>e.$emit("close")),"aria-label":"Close"})]),t("div",K,[y(k,{name:"dailyLimit",label:"Enter daily limit",type:"currency"}),y(k,{name:"absoluteLimit",label:"Enter absolute limit",type:"currency"}),y(k,{name:"withdrawLimit",label:"Enter withdraw limit",type:"currency"})]),t("div",Q,[t("button",{type:"button",class:"btn btn-secondary",onClick:a[1]||(a[1]=p=>e.$emit("close"))}," Cancel "),a[4]||(a[4]=t("button",{type:"submit",class:"btn btn-primary"}," Save Changes ",-1))])],32)])])]),a[5]||(a[5]=t("div",{class:"modal-backdrop fade show"},null,-1))]))}},X={key:0,class:"container my-5"},Y={class:"d-flex justify-content-between align-items-center mb-4"},tt=["disabled"],et={key:0,class:"alert alert-danger text-center"},st={key:1,class:"table table-light table-bordered table-hover text-center align-middle"},at=["onClick"],it={key:1},ot={"aria-label":"Page navigation example",class:"d-flex justify-content-center mt-4 align-items-center gap-3"},lt=["disabled"],nt={class:"text-muted fw-semibold"},rt=["disabled"],ut=10,ct={__name:"AccountsList",setup(g){const f=U(),s=V(),r=h(0),u=h(null),m=h(!1),b=h(null);function v(_){u.value=_}function e(){u.value&&(m.value=!0)}async function a(_){try{(await s.updateAccountLimits(_)).status===200?(m.value=!1,await p(),u.value=null,b.value.setToast("Account Limits Updated Successfully","success")):b.value.setToast("Failed to update account limits","error")}catch{b.value.setToast("Failed to update account limits","error")}}async function p(){s.fetchAllAccounts(r.value,ut)}N(r,p,{immediate:!0});function P(){r.value>0&&r.value--}function E(){s.isLastPage.value||r.value++}return(_,i)=>(l(),n($,null,[o(f).isAuthenticated&&o(f).isEmployee?(l(),n("div",X,[t("div",Y,[i[1]||(i[1]=t("h1",{class:"h2 m-0"},"Customer Accounts",-1)),t("button",{class:"btn btn-primary",onClick:e,disabled:!u.value}," Update Account Limits ",8,tt)]),o(s).error?(l(),n("div",et,d(o(s).error),1)):(l(),n("table",st,[i[3]||(i[3]=t("thead",{class:"table-success"},[t("tr",null,[t("th",null,"Customer Name"),t("th",null,"IBAN"),t("th",null,"Type"),t("th",null,"Balance")])],-1)),t("tbody",null,[o(s).userAccounts.length>0?(l(!0),n($,{key:0},M(o(s).userAccounts,(c,F)=>{var x;return l(),n("tr",{key:F,class:R(["clickable-row",{"table-active":((x=u.value)==null?void 0:x.iban)===c.iban}]),onClick:bt=>v(c)},[t("td",null,d(c.firstName)+" "+d(c.lastName),1),t("td",null,d(c.iban),1),t("td",null,d(c.type),1),t("td",null,d(o(L)(c.balance)),1)],10,at)}),128)):(l(),n("tr",it,i[2]||(i[2]=[t("td",{colspan:"4",class:"text-center text-muted fw-semibold"}," No accounts found. ",-1)])))])])),t("nav",ot,[t("button",{class:"btn btn-outline-primary",onClick:P,disabled:o(s).isFirstPage,title:"Previous Page"},i[4]||(i[4]=[t("i",{class:"bi bi-chevron-left"},null,-1),C(" Previous ")]),8,lt),t("span",nt," Page "+d(r.value+1)+" of "+d(o(s).totalPages),1),t("button",{class:"btn btn-outline-primary",onClick:E,disabled:o(s).isLastPage,title:"Next Page"},i[5]||(i[5]=[C(" Next "),t("i",{class:"bi bi-chevron-right"},null,-1)]),8,rt)])])):A("",!0),m.value?(l(),j(W,{key:1,account:u.value,onClose:i[0]||(i[0]=c=>m.value=!1),onSubmit:a},null,8,["account"])):A("",!0),y(q,{ref_key:"toastRef",ref:b},null,512)],64))}},dt=B(ct,[["__scopeId","data-v-061b219c"]]),mt={class:"container-fluid d-flex flex-column flex-grow-1 align-items-center p-0"},_t={__name:"AccountsView",setup(g){return(f,s)=>(l(),n("main",mt,[y(dt)]))}};export{_t as default};
